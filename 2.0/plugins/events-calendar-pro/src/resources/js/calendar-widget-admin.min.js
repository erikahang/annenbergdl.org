function calendar_toggle(a){a.find(".calendar-widget-filters-title").hide(),a.find(".calendar-widget-filters-operand").hide();var b=a.find(".calendar-widget-added-filters");if(b.length){var c=b.val()?jQuery.parseJSON(b.val()):new Object,d=get_term_count(c);d>0&&(a.find(".calendar-widget-filters-title").show(),d>1&&a.find(".calendar-widget-filters-operand").show())}}function calendar_toggle_all(){jQuery(".calendar-widget-filters-container").each(function(a,b){calendar_toggle(jQuery(b))})}function get_term_count(a){var b=0;for(var c in a)b+=a[c].length;return b}jQuery(document).ready(function(a){var b=a("body"),c={};b.is(".wp-customizer")&&(c={dropdownCssClass:"customizer-select2"}),a("div.widgets-sortables").on("sortstop",function(){setTimeout(function(){a("#widgets-right select.calendar-widget-add-filter").select2(c),calendar_toggle_all()},600)}),a("#widgets-right select.calendar-widget-add-filter").select2(c),b.on("change","select.calendar-widget-add-filter",function(){a(".calendar-widget-filters-container").show();var b=a(this),c=a(this.options[this.selectedIndex]),d=b.parents(".widget-content"),e=d.find(".calendar-widget-filter-list"),f=d.find(".calendar-widget-added-filters"),g=c.attr("value"),h=c.closest("optgroup"),i=h.attr("id"),j=h.attr("label");if(0!==parseInt(g)){var k=f.val()?a.parseJSON(f.val()):new Object;if(k[i]||(k[i]=new Array),-1==jQuery.inArray(g,k[i])){k[i].push(g),f.val(JSON.stringify(k));var l=a("<a/>").addClass("calendar-widget-remove-filter").attr("data-tax",i).attr("data-term",g).text("(remove)").attr("href","#"),m=a("<span/>").append(l),n=a("<li/>").append("p").text(j+": "+c.text()+"   ").append(m);e.append(n),calendar_toggle(d)}}}),b.on("click",".calendar-widget-remove-filter",function(b){b.preventDefault();var c=a(this),d=c.attr("data-tax"),e=c.attr("data-term"),f=c.parents(".widget-content"),g=f.find(".calendar-widget-added-filters"),h=g.val()?a.parseJSON(g.val()):new Object;h[d]&&h[d].myremove(e),g.val(JSON.stringify(h)),c.closest("li").remove(),calendar_toggle(f)}),Array.prototype.myremove=function(){for(var a,b,c=arguments,d=c.length;d&&this.length;)for(a=c[--d];-1!=(b=this.indexOf(a));)this.splice(b,1);return this},Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){b=b||0;for(var c=this.length;c>b;){if(this[b]===a)return b;++b}return-1})});